<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shop</title>
    
    <link rel="stylesheet" href="https://cdn.snipcart.com/themes/v3.4.1/default/snipcart.css" />
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; }
        h1 { text-align: center; margin-bottom: 30px; color: #333; }
        
        /* Category Styles */
        .category { margin-bottom: 15px; border: 1px solid #ddd; border-radius: 5px; overflow: hidden; }
        .category-header { background: #404040; color: white; padding: 15px 20px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; transition: background 0.3s; }
        .category-header:hover { background: #262626; }
        .category-content { max-height: 0; overflow: hidden; transition: max-height 0.3s ease; background: #f9f9f9; }
        .category-content.open { max-height: 2000px; padding: 20px; }
        .arrow { transition: transform 0.3s; }
        .arrow.open { transform: rotate(180deg); }

        /* Grid */
        .product-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 20px; }
        .product-card { background: white; border: 1px solid #ddd; border-radius: 8px; padding: 15px; text-align: center; display: flex; flex-direction: column; justify-content: space-between; }
        
        /* UPDATED IMAGE STYLES */
        .product-image { 
            width: 100%; 
            height: 200px; 
            object-fit: contain; /* This ensures the image isn't stretched/squashed */
            margin-bottom: 15px;
            border-radius: 5px;
        }

        .product-name { font-weight: bold; margin: 10px 0; color: #333; }
        .product-price { color: #262626; font-size: 18px; margin: 10px 0; }
        
        /* Dropdown */
        .product-select { width: 100%; padding: 8px; margin-bottom: 10px; border: 1px solid #ddd; border-radius: 5px; background: #fff; cursor: pointer; }
        
        /* Snipcart Button Styles */
        .snipcart-add-item { 
            background: #28a745; 
            color: white; 
            border: none; 
            padding: 10px 20px; 
            border-radius: 5px; 
            cursor: pointer; 
            width: 100%; 
            margin-top: auto; 
            font-size: 16px; 
            font-weight: bold; 
            transition: background 0.2s, transform 0.1s;
        }
        .snipcart-add-item:hover { background: #218838; }
        .snipcart-add-item:active { transform: scale(0.98); }

        /* Added State (Green) */
        .snipcart-add-item.added {
            background: #155724;
        }

        /* Floating Cart Button */
        .header-cart {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #404040;
            color: white;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            z-index: 1000;
            border: none;
            transition: transform 0.2s;
        }
        .header-cart:hover { background: #262626; }
        
        @keyframes shake {
            0% { transform: rotate(0deg); }
            25% { transform: rotate(-5deg); }
            50% { transform: rotate(5deg); }
            75% { transform: rotate(-5deg); }
            100% { transform: rotate(0deg); }
        }
        .header-cart.shake {
            animation: shake 0.4s ease-in-out;
            background: #28a745;
        }
    </style>
</head>
<body>

    <button class="header-cart snipcart-checkout" id="cartButton">
        ðŸ›’ Cart (<span class="snipcart-items-count">0</span>)
    </button>

    <div class="container">
        <h1>Urban Arts Centre Merchandise Store</h1>
        
        <div class="category">
            <div class="category-header" onclick="toggleCategory('tshirts')">
                <h2>T-Shirts</h2><span class="arrow" id="arrow-tshirts">â–¼</span>
            </div>
            <div class="category-content" id="tshirts"><div class="product-grid" id="tshirts-grid"></div></div>
        </div>
        <div class="category">
            <div class="category-header" onclick="toggleCategory('posters')">
                <h2>Posters</h2><span class="arrow" id="arrow-posters">â–¼</span>
            </div>
            <div class="category-content" id="posters"><div class="product-grid" id="posters-grid"></div></div>
        </div>
        <div class="category">
            <div class="category-header" onclick="toggleCategory('badges')">
                <h2>Badges</h2><span class="arrow" id="arrow-badges">â–¼</span>
            </div>
            <div class="category-content" id="badges"><div class="product-grid" id="badges-grid"></div></div>
        </div>
        <div class="category">
            <div class="category-header" onclick="toggleCategory('stickers')">
                <h2>Stickers</h2><span class="arrow" id="arrow-stickers">â–¼</span>
            </div>
            <div class="category-content" id="stickers"><div class="product-grid" id="stickers-grid"></div></div>
        </div>
        <div class="category">
            <div class="category-header" onclick="toggleCategory('booklets')">
                <h2>Graphic Booklets</h2><span class="arrow" id="arrow-booklets">â–¼</span>
            </div>
            <div class="category-content" id="booklets"><div class="product-grid" id="booklets-grid"></div></div>
        </div>
        <div class="category">
            <div class="category-header" onclick="toggleCategory('bundles')">
                <h2>Bundles</h2><span class="arrow" id="arrow-bundles">â–¼</span>
            </div>
            <div class="category-content" id="bundles"><div class="product-grid" id="bundles-grid"></div></div>
        </div>
    </div>

    <script async src="https://cdn.snipcart.com/themes/v3.4.1/default/snipcart.js"></script>
    
    <div hidden id="snipcart" 
         data-api-key="MzAzZThmZDItMTgwZi00YzE3LWE4YmYtYzUzZmQ3YjgwMGI1NjM5MDQ0Mzg5OTYwMzUyMDcw"
         data-config-add-product-behavior="none"
         data-config-modal-style="side">
    </div>

    <script>
        // CONFIGURATION
        // NOTE: Replace the image URLs with your real links
        const products = {
            tshirts: [
                { 
                    id: 'tshirt1', 
                    name: 'Tales From Oblivion T-Shirt', 
                    price: 18.00,
                    image: 'https://raw.githubusercontent.com/tedelston/uac_merch_shop/refs/heads/main/TFO%20T-Shirt.png', // REPLACE THIS
                    sizes: 'Small|Medium|Large|XL|2XL|3XL|4XL' 
                },
                { 
                    id: 'tshirt2', 
                    name: 'Listen T-Shirt', 
                    price: 18.00, 
                    image: 'https://raw.githubusercontent.com/tedelston/uac_merch_shop/refs/heads/main/Listen%20T-Shirt.png', // REPLACE THIS
                    sizes: 'Small|Medium|Large|XL|2XL|3XL|4XL'
                }
            ],
            posters: [
                { id: 'poster1', name: 'Tales From Oblivion Poster', price: 7.50, image: 'https://raw.githubusercontent.com/tedelston/uac_merch_shop/refs/heads/main/tfo%20poster.png' },
                { id: 'poster2', name: 'House of the Lost Poster', price: 7.50, image: 'https://raw.githubusercontent.com/tedelston/uac_merch_shop/refs/heads/main/HOL%20POSTER.png' },
                { id: 'poster3', name: 'Irish Ghost Stories Poster', price: 7.50, image: 'https://raw.githubusercontent.com/tedelston/uac_merch_shop/refs/heads/main/IGS%20Poster.png' }
            ],
            badges: [
                { id: 'badge1', name: 'Tales From Oblivion Badge', price: 3.00, image: 'https://raw.githubusercontent.com/tedelston/uac_merch_shop/refs/heads/main/tfo%20badge.png' }
            ],
            stickers: [
                { id: 'sticker1', name: 'Tales From Oblivion Sticker', price: 2.50, image: 'https://raw.githubusercontent.com/tedelston/uac_merch_shop/refs/heads/main/tfosticker.png' }
            ],
            booklets: [
                { id: 'booklet1', name: 'Tales From Oblivion Graphic Booklet', price: 5.00, image: 'https://raw.githubusercontent.com/tedelston/uac_merch_shop/refs/heads/main/TFO%20Booklet%20cover.png' }
            ],
            bundles: [
                { id: 'bundle1', name: 'Tales From Oblivion Bundle', price: 15.00, image: 'https://raw.githubusercontent.com/tedelston/uac_merch_shop/refs/heads/main/TFO%20Bundle.png' }
            ]
        };

        function loadProducts() {
            const currentUrl = window.location.href;

            for (let category in products) {
                const grid = document.getElementById(category + '-grid');
                products[category].forEach(product => {
                    const card = document.createElement('div');
                    card.className = 'product-card';
                    
                    let customFields = '';
                    let sizeSelector = '';
                    
                    if (product.sizes) {
                        const sizeOptions = product.sizes.split('|');
                        let optionsHtml = sizeOptions.map(s => `<option value="${s}">${s}</option>`).join('');
                        sizeSelector = `<select class="product-select" onchange="updateSize(this, '${product.id}')">${optionsHtml}</select>`;
                        
                        customFields = `
                            data-item-custom1-name="Size"
                            data-item-custom1-options="${product.sizes}"
                            data-item-custom1-value="${sizeOptions[0]}"
                        `;
                    }

                    // UPDATED: Added referrerpolicy="no-referrer" to the <img> tag
                    card.innerHTML = `
                        <img src="${product.image}" alt="${product.name}" class="product-image" referrerpolicy="no-referrer">
                        <div class="product-name">${product.name}</div>
                        <div class="product-price">Â£${product.price.toFixed(2)}</div>
                        ${sizeSelector}
                        <button class="snipcart-add-item"
                            id="btn-${product.id}"
                            onclick="animateButton(this)"
                            data-item-id="${product.id}"
                            data-item-price="${product.price}"
                            data-item-url="${currentUrl}" 
                            data-item-name="${product.name}"
                            data-item-image="${product.image}"
                            ${customFields}>
                            Add to Cart
                        </button>
                    `;
                    grid.appendChild(card);
                });
            }
        }

        function animateButton(btn) {
            const originalText = btn.innerText;
            btn.innerText = "âœ” Added";
            btn.classList.add('added');
            const cartBtn = document.getElementById('cartButton');
            cartBtn.classList.add('shake');
            setTimeout(() => {
                btn.innerText = originalText;
                btn.classList.remove('added');
                cartBtn.classList.remove('shake');
            }, 2000);
        }

        function updateSize(selectElement, productId) {
            const button = document.getElementById('btn-' + productId);
            button.setAttribute('data-item-custom1-value', selectElement.value);
        }

        function toggleCategory(categoryId) {
            const content = document.getElementById(categoryId);
            const arrow = document.getElementById('arrow-' + categoryId);
            content.classList.toggle('open');
            arrow.classList.toggle('open');
        }
        
        document.addEventListener('snipcart.ready', function() {
            Snipcart.events.on('theme.routechanged', (routesChange) => {
                if (routesChange.to === "/") {
                    Snipcart.api.modal.close();
                }
            });
        });

        loadProducts();
    </script>
</body>
</html>
